{"version":3,"file":"src_app_Agendar_Agendar_module_ts.js","mappings":"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","sources":["./src/app/Agendar/Agendar-routing.module.ts","./src/app/Agendar/Agendar.module.ts","./src/app/Agendar/Agendar.page.ts"],"sourcesContent":["import { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { AgendarPage } from './Agendar.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: AgendarPage,\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class AgendarPageRoutingModule {}\n","import { IonicModule } from '@ionic/angular';\nimport { RouterModule } from '@angular/router';\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { AgendarPage } from './Agendar.page';\n\n\nimport { AgendarPageRoutingModule } from './Agendar-routing.module';\nimport { HeaderModule } from '../header/header.module';\nimport { TabsModule } from '../tabs/tabs.module';\n\n@NgModule({\n  imports: [\n    IonicModule,\n    CommonModule,\n    FormsModule,\n    RouterModule.forChild([{ path: '', component: AgendarPage }]),\n    AgendarPageRoutingModule,\n    HeaderModule,\n    TabsModule\n  ],\n  declarations: [AgendarPage]\n})\nexport class AgendarPageModule {}\n","import { Component } from '@angular/core';\nimport { LocalStorageServiceService } from 'src/service/local-storage-service.service';\nimport { GetDataBackendService } from 'src/service/get-data-backend.service';\nimport { AlertController } from '@ionic/angular';\n\n@Component({\n  selector: 'app-Agendar',\n  templateUrl: 'Agendar.page.html',\n  styleUrls: ['Agendar.page.scss']\n})\nexport class AgendarPage {\n  ButtonAtras: boolean = true;\n  DatosUser: any\n  DatosAgen: any = {\n    idAgenda: '',\n    idUser: '',\n    idBarbero: '',\n    Cantidad: '',\n    Servicios: '',\n    Dia: '',\n    Fecha: '',\n    Hora: [],\n    Monto: 0\n  }\n  CantidadDisp: any = []\n  HorasDisp: any = []\n  ListServicio: any = []\n  ListJornada: any = []\n  JornadaSelect: any\n  DatosAgendar: any = []\n\n  constructor(\n    private _localstorage: LocalStorageServiceService,\n    private _GetData: GetDataBackendService,\n    private alertController: AlertController\n  ) { }\n\n  ngOnInit() {\n    //asigno los datos del usuario que tengo en el local storage \n    this.DatosUser = JSON.parse(this._localstorage.BuscarItem('DatosUser'))\n\n    // llamo los metodos que buscan los servicios y las jornadas \n    this.GetDatosServicios()\n    this.GetDataJornadas()\n  }\n\n  GetDatosServicios() {\n    try {\n\n      //llamo mi Service pasando el id del barbero para obtener slos serivicos del barbero \n      this._GetData.GetServicios(this.DatosUser.idBarbero).then((ResServi: any) => {\n\n        //asigno los servicios obtendios a mi variable \n        this.ListServicio = ResServi\n\n      }).catch(err => console.error(err))\n\n    } catch (error) {\n      console.error(error)\n    }\n  }\n\n  GetDataJornadas() {\n    //busco las jornadas de trabajo\n    try {\n\n      //busco las jornadas de trabajo del barbero con su id de barbero \n      this._GetData.GetJornada(this.DatosUser.idBarbero).then((ResJornada: any) => {\n        //asigno los datos obtenidos a mi variable \n        this.ListJornada = ResJornada\n\n      }).catch(err => console.error(err))\n\n    } catch (error) {\n      console.error(error)\n    }\n  }\n\n  CalculoMonto() {\n    try {\n\n      //establesco el monto en 0 \n      this.DatosAgen.Monto = 0\n\n      //verifico que los servicios esten en arreglo\n      if (typeof this.DatosAgen.Servicios === 'string') {\n        this.DatosAgen.Servicios = [this.DatosAgen.Servicios]\n      }\n      //recorro todos los servicos seleccionados por el cliente \n      for (let index = 0; index < this.DatosAgen.Servicios.length; index++) {\n        //busco entre todos los servicios el servicio que el selecciono \n        const ServiceFind = this.ListServicio.find(S => S.Nombre === this.DatosAgen.Servicios[index])\n        //sumo el total a pagar \n        this.DatosAgen.Monto = this.DatosAgen.Monto + ServiceFind.Monto\n      }\n\n\n    } catch (error) {\n      console.error(error)\n    }\n  }\n\n  GetHorasDiponibles() {\n    try {\n\n      //verifico las horas disponibles y la cantidad de personas disponible\n      if (this.DatosAgen.Fecha) {\n        this.CantidadDisp = []// aqui guardare la cantidad de personas disponible \n        this.HorasDisp = [] // aqui las horas disponibles \n\n        //busco entre todas las jornadas, busco la que selecciono el cliente \n        this.JornadaSelect = this.ListJornada.find((Jorn: any) => Jorn.Fecha === this.DatosAgen.Fecha)\n\n        if (this.JornadaSelect) {\n          let Pos = 0  //Esta varible me va a yudar a saber cuantas horas tengo disponibles \n          //en este ciclo for recorro las horas disponibles \n          for (let index = 0; index < this.JornadaSelect.HorasDisponible.length; index++) {\n            //con este if verifico que solo tomare en cuenta las horas disponibles \n            if (this.JornadaSelect.HorasDisponible[index].status === true) {\n              Pos = Pos + 1\n              //inserto en el arreglo de cantidad disponible el numero de personas disponibles\n              this.CantidadDisp.push(Pos)\n              //Inserto en el arreglo de horas disponibles las horas que se puede seleccionar \n              this.HorasDisp.push(this.JornadaSelect.HorasDisponible[index].Hora)\n            }\n          }\n\n          this.DatosAgen.Cantidad = 1\n        }\n      }\n\n    } catch (error) {\n      console.error(error)\n    }\n  }\n\n  GuardarDatos() {\n    //buardo los datos en la base de datos\n    try {\n\n      //le asigno la fecha de la jornada seleccionada \n      const FechaA = new Date(this.DatosAgen.Fecha)\n\n      this.DatosAgen.idAgenda = Math.random().toString(36).substring(2, 8 + 2)//genero un id de agenda \n      this.DatosAgen.idUser = this.DatosUser.idUser // le asigno el id del usuairo \n      this.DatosAgen.idBarbero = this.DatosUser.idBarbero // le asigno el id del barbro \n      //obtengo el dia - mes - año del la jornada seleccionada \n      this.DatosAgen.Dia = `${FechaA.getDate()}-${FechaA.getMonth() + 1}-${FechaA.getFullYear()}`\n\n\n      if (typeof this.DatosAgen.Hora === 'string') {\n        // las horas disponibles tinene que estar en forma de arreglo, y si me llega en string las converito en arreglo\n        this.DatosAgen.Hora = [this.DatosAgen.Hora]\n      }\n\n      //recorro la jornada selelcionada para cambiarle el status a la hora seleccioanda por el cliente \n      for (let index = 0; index < this.JornadaSelect.HorasDisponible.length; index++) {\n\n        for (let indexElement = 0; indexElement < this.DatosAgen.Hora.length; indexElement++) {\n          //verifico si la hora por la que voy es igual a la que eligio el cliente \n          if (this.JornadaSelect.HorasDisponible[index].Hora === this.DatosAgen.Hora[indexElement].replace(/ /g, \"\")) {\n            //le coloco false al status de la hora para decir que ya fue seleccionada \n            this.JornadaSelect.HorasDisponible[index].status = false\n          }\n\n        }\n\n      }\n\n      //guardo los datos agendados por le cliente \n      this._GetData.InsertAgenda(this.DatosAgen).then((Res: any) => {\n        if (Res.status === true) {\n\n          //si todo salio bien ahora edito las horas que selecciono el cliente para indicar que ya no esta disponibles\n          this._GetData.UpdateJornada(this.JornadaSelect).then((ResJ: any) => {\n          }).catch(err => console.error(err))\n\n          this.DatosAgen = {\n            idAgenda: '',\n            idUser: '',\n            idBarbero: '',\n            Cantidad: '',\n            Servicios: '',\n            Dia: '',\n            Fecha: '',\n            Hora: [],\n            Monto: 0\n          }\n\n          this.ShowAlert('New')\n\n        } else {\n          this.ShowAlert('NewError')\n        }\n\n      }).catch((err: any) => { console.error(err); this.ShowAlert('NewError') })\n\n    } catch (error) {\n      console.error(error)\n    }\n\n  }\n\n\n  async ShowAlert(TipoAlert: String) {\n    try {\n\n      const alert = await this.alertController.create({\n        header: 'Su cita ha sido agendada con éxito',\n        buttons: ['Aceptar']\n      });\n\n      const alertError = await this.alertController.create({\n        header: '¡Hubo un error al agendar su cita!',\n        buttons: ['Aceptar']\n      });\n\n      switch (TipoAlert) {\n        case 'New':\n          await alert.present();\n          break;\n        case 'NewError':\n          await alertError.present();\n          break;\n      }\n\n    } catch (error) {\n      console.error(error)\n    }\n  }\n\n}\n"],"names":[],"sourceRoot":"webpack:///"}